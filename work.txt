this was 4 hours hardwork, but is easy to understand
